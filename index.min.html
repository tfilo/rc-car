<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>RC-Car</title><style>*{user-select:none}body,html{margin:0;padding:4px;width:100%;height:100%;background:#fff;overflow:hidden;touch-action:none;-ms-touch-action:none}.down,.horn,.left,.right,.stop,.up{position:absolute;border-radius:16px;font-size:xx-large;font-weight:900;color:#000;touch-action:manipulation;background-color:#d3d3d3;user-select:none}.down,.left,.right,.up{width:28%;height:40%}.up{top:5%;left:36%;border:4px solid green}.down{bottom:5%;left:36%;border:4px solid #00f}.left{top:30%;left:5%;border:4px solid #000}.right{top:30%;right:5%;border:4px solid #000}.horn,.stop{width:min(20vw,20vh);height:min(20vw,20vh);border:4px solid #000;display:flex;justify-content:center;align-items:center}.horn{top:5%;right:5%}.stop{bottom:5%;right:5%;color:red;font-size:large}.battery,.controls,.status{position:absolute;left:4px;font-size:small;display:flex;flex-direction:column}.status{top:4px}.battery{left:auto;right:4px;flex-direction:row;gap:4px}.controls{bottom:4px}.controls_label{display:inline-block;width:70px}.controls_raw_value{display:inline-block;padding-left:8px}</style><script>const HORN_OFF=0,HORN_ON=1,WAIT_MS=50,S_MIN=0,S_MAX=100;let steering=50;const REVERSE=-1,FORWARD_MIN=1,FORWARD_MAX=3,STOP=0;let drive=0,hasError=!1,requestCount=0,totalElapsedTime=0,horn=0;function forward(){drive=-1===drive?0:Math.min(drive+1,3)}function reverse(){drive=drive>0?Math.max(drive-1,0):-1}function stop(){drive=0}function left(){steering=Math.max(steering-10,0)}function right(){steering=Math.min(steering+10,100)}let horntimeout=null;function honk(){horn=1,clearTimeout(horntimeout),horntimeout=setTimeout(()=>{horn=0},500)}async function send(){const e=Date.now();let t=0;try{const n=new AbortController;setTimeout(()=>n.abort(),200);const r=await fetch(`/control?steering=${steering}&drive=${drive}&horn=${horn}`,{method:"POST",signal:n.signal});t=Date.now()-e,document.getElementById("status").innerHTML=r.status,r.ok&&r.json().then(e=>{const t=e.battery;if(t&&!isNaN(+t)){const e=(+t).toFixed(2);document.getElementById("battery").innerHTML=e}})}catch(e){document.getElementById("status").innerHTML=e.name}finally{requestCount++,totalElapsedTime+=t,setTimeout(()=>{send()},Math.min(Math.max(0,50-t),50))}}setInterval(()=>{document.getElementById("requestCount").innerHTML=requestCount,document.getElementById("elapsedTime").innerHTML=Math.round(totalElapsedTime/requestCount)+" ms",requestCount=0,totalElapsedTime=0},1e3),setInterval(()=>{document.getElementById("drive").value=drive+1,document.getElementById("steering").value=steering,document.getElementById("drive_value").innerHTML=drive,document.getElementById("steering_value").innerHTML=steering-50,document.getElementById("horn").style.backgroundColor=1===horn?"orange":"lightgray",document.getElementById("up").style.backgroundColor=drive>0?"lightgreen":"lightgray",document.getElementById("brake").style.backgroundColor=-1===drive?"lightblue":"lightgray",document.getElementById("left").style.backgroundColor=steering<50?"gray":"lightgray",document.getElementById("right").style.backgroundColor=steering>50?"gray":"lightgray"},100)</script></head><body onload="send()"><div class="status"><span>Status: <span id="status"></span></span> <span>Request: <span id="elapsedTime">0</span>; <span id="requestCount">0</span> req/s</span></div><div class="battery">Battery: <span id="battery">0</span> V</div><div class="controls"><span><span class="controls_label">Drive:</span><progress id="drive" value="1" max="4"></progress><span id="drive_value" class="controls_raw_value">0</span> </span><span><span class="controls_label">Steering:</span><progress id="steering" value="50" max="100"></progress><span id="steering_value" class="controls_raw_value">0</span></span></div><div><button id="horn" class="horn" onclick="honk()">&#128264;</button> <button id="up" class="up" onclick="forward()">&#8593;</button> <button id="brake" class="down" onclick="reverse()">&#8595;</button> <button id="left" class="left" onclick="left()">&#8592;</button> <button id="right" class="right" onclick="right()">&#8594;</button> <button class="stop" onclick="stop()">STOP</button></div></body></html>